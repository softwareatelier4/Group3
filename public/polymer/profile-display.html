<link rel="import" href="./components/polymer/polymer.html">
<link rel="import" href="./components/paper-input/paper-textarea.html"
<link rel="import" href="./star-rating.html">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Didact+Gothic">
<link rel="stylesheet" href="./components/font-awesome/css/font-awesome.min.css">
<link rel="import" href="./gallery-display.html">
<!--
This is the polymer component for the search field.
-->

<dom-module id="profile-display">
  <template>
    <style>
    :root{
    --main-color:#494E6B;
    --main-color-lighter:#5d6389;
    --second-color:#98878F;
    --third-color:#985E6D;
    --fourth-color:#192231;
  }
    h3,.desc{
      color: #595959;
      font-weight: bold;
      font-style: italic;
      font-family: Didact Gothic;
    }
    .desc span{
      color:black;
      font-style:normal;
    }
    h4{
      color: green;
      font-family: Didact Gothic;
    }
    .collumn{
      align-self: stretch;
      padding:2%;
    }
    #body{
      background-color:#f2f2f2;
      padding:5%;
      font-family: Didact Gothic;
      margin-left: 15%;
      margin-right: 15%;
    }
    #contact-container{
      background-color:  #e6e6e6;
      padding: 8%;
      border-left-style: solid;
      border-width: 4px;
      border-color: var(--main-color);
      font-size: 18px;
    }
    .button {
      background-color:var(--main-color);
      border: none;
      color: white;
      padding: 15px 32px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 16px;
    }
    .button:hover{
      background-color: var(--main-color-lighter);
    }
    a:visited {
      color:#192231
    }
    #anotherContainer{
      align-items: stretch;
      display: -webkit-flex;
      display: flex;
    }


    fieldset, label { margin: 0; padding: 0; }
    body{ margin: 20px; }
    h1 { font-size: 1.5em; margin: 10px; }

    /****** Style Star Rating Widget *****/

    .rating {
      border: none;
      float: left;
    }

    .rating > input { display: none; }
    .rating > label:before {
      margin: 5px;
      font-size: 1.25em;
      font-family: FontAwesome;
      display: inline-block;
      content: "\f005";
    }

    .rating > .half:before {
      content: "\f089";
      position: absolute;
    }

    .rating > label {
      color: #ddd;
    float: right;
    }

    /***** CSS Magic to Highlight Stars on Hover *****/

    .rating > input:checked ~ label, /* show gold star when clicked */
    .rating:not(:checked) > label:hover, /* hover current star */
    .rating:not(:checked) > label:hover ~ label { color: #FFD700;  } /* hover previous stars in list */

    .rating > input:checked + label:hover, /* hover current star when changing rating */
    .rating > input:checked ~ label:hover,
    .rating > label:hover ~ input:checked ~ label, /* lighten current selection */
    .rating > input:checked ~ label:hover ~ label { color: #FFED85;  }



    </style>
  <div id="body">
    <div id="anotherContainer">
    <div class="collumn">
      <h1>[[profile.firstName]] [[profile.lastName]]</h1>
      <h3>[[profile.job]] in [[profile.location]]</h3>
      <div class="freelancer-container">
        <img src ="../img/profile_pic.png">
        <div class="desc">Member since: <span>20. March 2017</span></div>
      </div>
      <div id="contact-container" style = "width: 300px" >
        <div class= "desc">Email: <span>{{profile.email}}</span></div>
        <p style="font-size:5px"></p>
        <div class= "desc">Tel: <span>{{profile.telephoneNum}}</span></div>
        <p style="font-size:5px"></p>
        <div class= "desc">Website: <span>{{profile.website}}</span></div>
        <p style="font-size:5px"></p>
        <div class= "desc">Skype: <span>{{profile.skypeAcc}}</span></div>
        <p></p>
        <center>
        <paper-button  target="_top">
          <a href="mailto:{{profile.email}}?Subject=Booking%20JobAdvisor" class = "button" >
            Book Now!</a>
          </paper-button>
        </center>
      </div>
      <a href = "{{profile.facebook}}">
        <i class="fa fa-facebook-official fa-3x" aria-hidden="true"></i>
      </a>
      <a href = "{{profile.linkedin}}">
        <i class="fa fa-linkedin-square fa-3x" aria-hidden="true"></i>
      </a>
      <a href = "{{profile.skypeAcc}}">
        <i class="fa fa-skype fa-3x" aria-hidden="true"></i>
      </a>
      <a href = "{{profile.github}}">
        <i class="fa fa-github-square fa-3x" aria-hidden="true"></i>
      </a>
    </div>

    <div class= "collumn">
      <h2>Rating</h2>
      <div>
        <h3> Overall </h3>
        <star-rating rating= "4"></star-rating> <br>
        <h3> Price </h3>
        <star-rating rating="3"></star-rating> <br>
        <h3> Quality </h3>
        <star-rating rating="5"></star-rating> <br>
      </div>
    </div>
    <div class = "collumn">
      <h2>About</h2>
      <div style="overflow: scroll; width:300px;"> [[profile.description]] </div>
      <gallery-display>
      </gallery-display>
    </div>

  </div>
  <div>Comments</div>
  <div>

  </div>
  <div>
  <paper-textarea id="" value="{{reviewComment}}" label="Review [[profile.firstName]] [[profile.lastName]]" rows="3" max-rows="5"></paper-textarea>
  <paper-button on-tap="handlePosting">POST</paper-button>
  </div>

  <template is="dom-repeat"  items="{{reviews}}">
    <div>
      {{item.reviewText}}
    </div>
  </template>
</div>


<iron-ajax
  auto
  url="/freelancer/[[freelancerId]]"
  on-response="handleResponse"
></iron-ajax>
<iron-ajax
  auto
  url="/review/freelancer/[[freelancerId]]"
  on-response="handlereview">
</iron-ajax>

<iron-ajax
  id="ajax"
  handle-as="json"
  content-type="application/json"
  method="POST"
  body="{{newReview}}"
  url="/review"
  debounce-duration="3000">
  </template>

  <script>
    Polymer({

      is: 'profile-display',
      ready: function() {
        this.profile =
            {firstName: 'Bob', lastName: 'Palazzi', location: 'Lugano', email: 'username@example.com',
            job: 'Plumber', telephoneNum: "0123456789",review:3,dateCreated: '01',description:'description' }
      },
      attached:function(){
        console.log("here")
      },

      properties: {
        freelancerId: {
          type: String
        },
        reviews: {
          type: []
        }
      },
      handleResponse:function(res){
        this.profile.displayDate = formatDate(new Date(res.detail.response.dateCreated));
        this.profile=res.detail.response;
      },
      handlereview: function(res){
        this.reviews = res.detail.response;
        console.log(this.reviews);
      },
      handlePosting: function(){
        let review ={}
        review.freelancer=this.freelancerId;
        review.reviewText=this.reviewComment;
        review.reviewRatingOverall = 3;
        review.reviewRatingPrice = 3;
        review.reviewRatingQuality = 3;
        this.newReview = JSON.stringify(review);
        this.$.ajax.generateRequest()
        this.push('reviews', review)
      }
    });
    function formatDate(date) {
      var monthNames = [
        "January", "February", "March",
        "April", "May", "June", "July",
        "August", "September", "October",
        "November", "December"];

  var day = date.getDate();
  var monthIndex = date.getMonth();
  var year = date.getFullYear();

  return day + ' ' + monthNames[monthIndex] + ' ' + year;
}




  </script>
</dom-module>
